Orig: Thanks to David Balder for providing several enhancements as well as a DLL for windows.
New: Thanks John Evans' excellent original work!
